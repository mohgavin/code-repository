from __future__ import print_function
import os
import sys
import os.path
import shutil
import pandas as pd
from datetime import datetime, timedelta
import zipfile
from dateutil import rrule
import warnings

def combine_mdt(s_date):
	path = '/var/opt/common5/mdt'
	dict_cellname = {}


	path_daily = '/var/opt/common5/mdt/%s' %s_date
	if not os.path.exists(path_daily):
		os.mkdir(path_daily)


	list_file = ['mdt_result', 'ue_traffic', 'ue_meas']
	#list_file = ['mdt_result']
	dict_columns = {}
	dict_columns['mdt_result'] = ['date', 'site', 'enodebid', 'ci', 'longitude', 'latitude', 'mmes1apid', 'rsrp_serving', 'rsrq_serving', 'CA_capable', 'CA_3CC_capable', 'MIMO4x4', 'ENDC', 'NR_SA']
	dict_columns['mdt_result'] = ['date', 'hour', 'site', 'enodebid', 'ci', 'longitude', 'latitude', 'mmes1apid', 'altitude', 'rsrp_serving', 'rsrq_serving']
	dict_columns['ue_traffic'] = []
	dict_columns['ue_meas'] = []
	dict_columns['result_ue_cap'] = []
	#list_site = ['4424974E', '4424739E', '441PX427E_CO', '441PL390E_CO', '441PL065E_CO', 'MC4431290E', 'SH3421104G_CO', '5018G_CO', '4424949E_CO', '441PC957E', '441PC430E_CO', '4410786E_CO', '441PX077E', '441PX087E', '441PL026E_CO', '4424902E', '442PL658E', '4424933E', '4425013E', '441PC256E_CO', '4425498E_BB', '4425007E_CO', 'V061G_CO', '441PL503E_CO', '441PC164E', 'SH4431545E', '341PC995G_CO', '442PC019E', '441PL074E_CO', '441PC902E', '441PL609E_CO', '341PX400G_CO', '5022G_CO', '442PX4803E', '441PX371E', '441PX910E_CO', '442PC087E', '441PL060E_CO', '441PL461E', '441PC199E_CO', '441PL384E_CO', '4424974E_BB', '441PX078E', '441PX094E_CO', 'MC4424718E', '4433055E', '341SC996G_CO', '441PX323E', '441PC960E_CO', '442PC009E_CO', '5016G_CO', '441PX364E_CO', '442PX349E_CO', '441PC439E', '442PC032E', '5015G_CO', '442PC472E', '4433058E', '5022G_C2', '441PC498E_CO', '442PC225E', '441PC173E', '3412390G_CO', '441PC402E', '5265G_CO', '441PC083E', 'SH4412317E_CO', '442PC179E', '4435480E', '3412296G_CO', '441A088E_CO', '441PC039E', '341PC251G_CO', '441PC124E', 'MC4415798E', '441PC805E', '442PC079E', '441PX029E']
	list_site = [450486,450467,450793,452249,460633,440883,440017,450836,452015,452223,450837,450838,451957,450839,460562,461503,460559,460634,461642,461659,460680,460635,460847,462019,460636,461744,461770,460687,460644,461687,450735,450710,450036,450183,452235,450216,451793,451982,450481,450204,450037,450438,451549,450222,410150,450420,452144,460637,460551,461905,460982,460652,461725,460956,450230,461830,460852,460681,461049,460654,461766,460803,461415,461269,460655,461477,461941,460650,461713,460761,461568,460656,461051,460645,461537,461409,460657,461711,461937,461052,461479,461299,460658,450815,451203,451204,460682,462036,460638,451363,460983,450178,452262,410151,460328,450840,460043,461403,452233,450038,450542,452265,452072,450495,451398,450175,452031,440352,460378,461785,461658,460356,460566,452042,452160,450040,450666,452029,460044,460342,460045,461280,460396,461458,460394,450799,452035,440367,440822,450147,451732,450206,452112,452046,450672,451527,450016,460560,460347,460572,461413,460683,460639,461258,461784,460581,440361,440881,440402,452332,450181,450179,452094,450041,450042,452006,451739,450901,452389,410562,450043,451785,451601,450841,450504,450464,450434,452213,450213,452377,410157,450306,410158,452220,450476,410159,410160,460046,461548,440021,410161,450842,451473,450843,452131,410869,410556,451335,452091,452081,450316,440360,440828,452030,452378,450274,452124,452216,450697,450150,460340,461804,461647,460354,460015,461384,451496,450505,450208,451510,450707,410546,411097,451895,450700,460381,451450,411207,410165,410705,411104,450354,450308,410166,451674,450781,452060,461907,460777,461745,460668,450670,451611,460582,460814,461567,450691,450046,451390,452067,450047,460648,460670,461346,460630,460631,450198,450739,450017,452219,460379,461392,460569,461257,460410,460234,461397,460391,461623,450745,451789,460751,460621,461464,410559,451016,451698,410845,460558,461943,411195,410810,410846,411144,410847,410848,411225,410171,410806,410852,410841,410801,411152,411309,411090,411061,411227,410544,410176,411123,410178,450990,450271,450248,411188,411187,411162,410695,410693,411243,410691,411138,410550,410563,411113,410653,410570,411286,410843,410809,411262,410541,410655,411224,410657,410892,411244,410554,410181,411135,411070,410182,410549,410183,410828,410701,410532,411245,411130,410537,410147,411196,410844,411226,410551,410536,410696,411095,410189,440345,460632,461913,461128,460016,461614,460393,460369,462013,450188,451924,460395,461722,450001,451528,460047,461844,460548,460547,461382,451622,451137,410190,460552,460386,461492,460371,461915,460991,461432,461621,460557,450678,451362,461584,460374,450822,451999,451871,450436,410191,411206,450190,452258,452128,450328,450719,451602,450291,450167,450327,451623,451356,450540,410558,411102,451765,450698,410880,410192,450148,451762,460563,461645,440568,440024,410803,410199,411139,461723,460691,461165,460780,461043,450325,450048,451694,450275,450272,451631,450813,452115,450814,450309,450904,451633,450733,452381,451202,440373,440825,440343,440025,410548,411184,410200,411209,410688,450049,451736,450050,452118,440337,450191,451654,450281,450701,451737,450234,450235,450168,451788,452136,450052,451530,461805,460370,450830,451863,450748,460385,460943,461649,460676,461839,460790,452215,450832,460677,461828,450018,452385,451958,450687,460383,461656,451865,451113,450529,461878,461879,461619,460679,460783,460725,410891,451855,450292,452259,450714,450265,451605,452267,450715,450717,451887,452116,450782,451614,450358,460362,461721,461814,460561,450792,451382,450303,452129,450226,451657,450053,451507,452089,450519,451585,450716,411185,450054,451972,450141,450783,452277,450158,450307,451801,411208,410223,410225,410533,410231,411107,410569,411114,410232,410233,411067,410234,411212,410565,411171,410601,410235,411186,410595,411108,410245,410829,411039,452279,411291,411279,411270,460667,460640,460550,461715,461373,460641,460647,461689,452164,450897,451977,410262,411119,450055,450056,451881,451990,410263,450153,451763,450992,451701,450708,450816,451216,450818,451218,452119,450057,451538,450536,440030,451952,450470,460628,451638,450905,452073,440905,440031,440363,440032,440879,460684,450699,452110,450202,451891,461838,460686,460643,450844,460936,462016,460930,461736,460188,452217,452218,450665,451771,450492,461405,460194,450249,410611,460554,461803,460389,460375,461693,451692,410265,460183,410802,451949,451295,450461,410543,410831,460203,451132,410552,450498,450002,440340,460195,461018,451283,450500,460018,410849,461020,451284,452152,450162,410557,460019,461340,461125,461999,450187,451291,451292,461357,461976,461029,451467,451806,451433,451439,451435,451592,451488,451412,452364,451428,451416,452394,451444,451947,451448,410850,410901,421085,451794,461193,451418,451417,461194,451298,451436,461195,461226,461994,462028,461218,451296,452365,451470,411072,411125,451755,451710,451756,451754,452308,452307,410545,410535,461857,461022,461203,460954,461027,461372,410539,461108,451483,451455,411292,410268,451293,452366,461233,450494,451294,451306,411161,410851,460161,411159,410547,440346,461025,450493,440239,451290,461023,450738,451289,451460,451434,440719,451130,451852,451148,451850,451677,451151,451166,451790,451169,451178,451686,451183,451184,451187,452271,451190,452010,451200,451430,451445,451411,451427,451377,451366,451425,451442,452390,451424,451383,451379,451380,451401,452151,451387,451423,451388,451422,451502,451447,460051,461754,461553,460199,440035,440796,440038,440841,440039,440669,440524,440634,440756,461611,440388,440787,440788,440540,440929,440529,440063,440064,440880,440728,440805,440807,440903,440911,440912,440265,440779,440065,440864,452386,440607,440068,440904,440336,440370,440866,440072,440073,440724,440909,440525,410561,440358,440344,440369,440076,440078,440599,440349,440814,440350,440824,440374,440804,440531,440364,440530,440366,440821,440082,440574,440834,440356,440085,440475,440810,440572,440915,440086,440818,440335,440088,440789,440089,440830,440874,440477,440485,440826,440486,440488,440499,440500,440501,440579,440867,440939,451249,451959,440390,440886,440348,440110,440111,440112,440113,440398,440601,440114,440115,440375,440803,440353,440133,440861,440333,440935,440140,440602,440141,440865,440142,440819,440359,440376,440144,440918,440351,440197,440285,440160,440823,451508,450058,450060,451777,450061,451954,450019,452033,450062,452273,450063,450064,452103,451662,450130,451723,451562,450065,451554,452239,451574,450696,450066,451399,461247,452002,450674,450679,451036,451900,452165,450661,451965,451359,452099,452285,451037,451613,450911,451759,452163,451835,452315,450706,451912,451372,450214,451001,451915,452184,450067,452237,452011,452238,450020,450998,450189,451910,450468,451966,451603,451684,450068,451582,451572,450003,450479,451920,450660,451569,451576,450069,450449,451746,450155,451880,450070,452023,450144,450451,452130,450501,450454,452065,450507,450465,450750,450475,450071,450673,452135,450478,451452,450683,451570,450312,451609,451230,450702,451791,450149,451000,450072,451122,451640,451829,450186,450301,450999,450497,452153,450469,460174,451942,450472,460373,461412,450508,451331,450846,450530,450236,451004,450232,451492,450520,450487,452358,450736,451703,451882,451596,451818,450315,450296,451888,450005,450482,460359,461747,450259,450680,452106,451845,450513,450435,451779,450074,451514,451830,450355,451302,450617,450075,450618,451911,450021,452228,451560,451681,450626,451464,452062,451111,452166,451465,450228,451766,450076,450834,451951,450474,450491,450022,451512,450300,451886,450784,451343,450326,450023,451516,452243,450322,451916,450416,450766,450340,450419,451598,450286,452142,450471,450077,451730,450488,450266,452093,450336,451721,451695,450352,450835,451953,451341,450288,450865,452007,451676,450820,450024,450317,451542,450338,451114,451567,450263,450025,451584,451877,450282,450026,450740,451699,450229,452037,450671,451948,450166,450348,452149,451541,451991,450876,452107,451707,450705,450713,450078,452098,450278,450425,451540,452181,451683,451536,452003,450915,451693,450027,451595,451336,450079,450172,450906,451632,450287,451738,450345,450343,450344,450517,450337,450353,450285,451002,450346,452266,451025,450440,451532,450983,451713,451032,451033,452025,451551,452173,451522,450262,451816,450332,450324,451768,451621,452170,450080,450684,450294,451550,452325,450734,452169,452246,450870,450689,452247,451236,450273,451648,450081,451984,450663,450196,452074,450490,451669,450323,450251,451876,450028,451805,450242,451533,452038,450313,450006,461407,450982,452174,451523,451548,451663,451655,450082,451518,452001,450621,450985,451480,451263,451672,451028,451260,452132,451269,451031,450655,450908,452159,450868,451012,450833,451504,451591,451758,451259,451524,450648,450650,450984,451586,450620,450342,450688,451246,452117,450647,451702,450610,451301,440598,451304,452123,452100,450646,450627,451827,451561,450681,450912,450007,451525,452022,451760,451521,452028,451757,451589,451471,452291,451491,451936,452077,450603,451597,450431,451670,452013,450463,450686,450029,451897,450867,450753,450692,451846,450444,450825,450489,451626,450732,451998,451237,451828,451123,451892,450227,451238,450163,451962,450246,450174,450199,451278,451135,452399,451252,450894,451511,450743,451371,450512,452061,451034,450347,450212,451026,450160,450280,450253,450083,452176,450279,450703,450268,450453,450424,451394,450506,450311,451802,450030,451817,451239,450210,450330,451840,451534,451240,450991,451813,450429,450695,411216,450084,451477,450896,451896,451978,450085,451241,451858,460162,451015,452039,450731,452150,451035,451280,450473,452068,452066,451281,450886,450887,450730,452027,450159,452264,450215,450086,450087,452104,450157,450790,450882,450289,451600,450611,450170,451256,450791,450357,452359,451008,451769,450297,451981,450243,451983,451253,451299,450319,451986,450511,451637,450224,452063,451018,451267,452362,451011,452360,450089,451320,450669,451139,450090,452161,450008,451733,450829,451125,451243,451851,450293,450231,450913,451973,450668,452036,450091,450341,450298,450917,451385,451023,450277,450918,450693,452368,452178,450628,450631,451482,451009,452156,451019,452177,450637,451994,451262,450642,451010,451697,450643,452380,451007,450644,452179,450711,451808,452172,450970,450778,450971,451369,451039,451921,451041,452092,451042,451045,451082,451064,451786,451065,451066,452270,451085,451089,451090,451803,451643,451103,451706,451105,452145,451188,451129,452175,451189,452209,451196,451197,452274,451303,451365,451559,451517,451282,450676,451956,450318,450302,452340,450333,452127,450339,450284,450768,450290,450335,451922,452211,452212,450690,451963,450747,451529,451264,450614,451944,451705,451257,451782,451268,450092,450616,451254,452384,450622,450623,452021,451265,452207,451272,451017,451646,451370,451783,451022,452206,450981,451271,450625,452045,452372,450652,451261,451995,451270,452138,452155,451258,451275,452214,451029,451781,450653,451030,450654,451946,451273,451229,451526,450823,450866,451934,450824,450827,450845,450919,452043,452341,450914,450891,450916,450767,452126,451375,450746,450518,450744,450883,452137,450871,450893,451386,452336,450909,450885,450877,450878,450630,451773,450632,452230,452231,450619,452026,451266,451021,451024,452229,450604,451274,451255,452205,451276,451027,451996,451126,451849,451247,452275,450755,450757,451943,450761,450093,451740,450929,451040,451075,451043,451642,451044,451046,451077,451078,451049,451051,461153,451053,451980,451884,451054,451690,451055,451061,452064,451062,451063,451067,451068,451069,452102,451070,452085,451606,451071,451087,452000,451088,451096,451104,452251,451091,451127,451143,451933,451145,451918,451146,451147,451400,451152,451155,451157,451463,451160,451162,451163,452203,451357,452086,451165,451167,452122,451397,452048,451168,452114,451170,451171,452147,452278,451172,451176,451804,451182,451185,452254,451186,451358,451361,451451,451708,451324,450094,450095,452257,450096,452143,450484,451461,450177,451727,450097,450098,451787,450151,450441,450450,451960,450349,450528,452044,451792,450142,450031,452240,452234,450099,451800,450260,450331,451636,450320,452361,450100,450310,450184,451971,450786,450295,450752,452004,452005,450900,450269,452080,450101,451347,450538,451885,452125,450102,450195,450270,451810,450304,450103,451682,450220,450203,450207,451815,450194,451652,450787,450104,451714,450105,452224,450201,452290,450192,450143,450785,452335,452109,450152,451870,450448,450009,451599,450010,452134,452346,450432,451649,450751,451955,450510,450239,450237,451431,450795,451997,451807,450205,450032,452097,450267,452253,450107,451831,450108,450458,451340,460762,461677,450439,451647,450264,450426,450109,450185,451872,450110,450460,450111,451964,450899,451825,450180,451210,450112,450114,450115,452379,450541,450116,451650,451449,450117,450118,452400,450445,452154,450427,451675,450428,450797,450798,450522,451619,450737,451325,452087,450252,452088,451988,452281,452282,451901,452071,452292,451987,451907,451666,411174,451659,451917,452357,451745,452139,452222,452287,452286,452349,452317,452353,452322,452321,452324,452299,452298,452319,452327,452289,452288,452263,452314,452339,452338,452309,452331,452326,452350,452351,452348,452354,452347,452352,452373,452369,451612,452041,451742,451841,452069,452070,451903,451724,452040,452337,451709,452084,451795,452016,450119,450033,452280,451136,451711,450443,450156,450014,452141,450502,450154,451716,450121,450350,451634,450122,451639,451509,450123,451348,450124,450125,450527,451515,450126,450351,451317,450321,452252,450305,451337,450034,450299,452367,450127,451799,450539,451493,450035,452032,450543,461740,460032,461582,460033,461603,461511,461703,461417,461910,461702,461968,461967,462003,462004,461980,461979,461988,461977,461989,461997,460689,460825,461565,461151,460701,460704,460705,460706,460708,460726,461142,461075,460727,460728,460729,461076,461077,461082,461152,461868,461822,461083,461087,461092,461084,461088,461637,461143,460733,461148,460734,460735,461089,460793,461091,460740,460794,460743,460744,460745,460746,460747,460914,461508,460913,461622,461616,460911,460910,460912,460925,460957,460958,460959,462023,460960,460963,460964,461147,460965,460966,461741,460968,460969,460970,461145,460974,460975,461904,460978,460971,461821,460972,460973,461807,461557,460980,461146,461166,461211,461207,461201,461158,461204,461188,461169,461776,461210,461825,461205,461160,461170,461167,461216,461181,461168,461209,461157,461219,461228,461244,461564,460052,462014,461388,460540,460513,461250,460514,461580,460515,460521,461777,460401,461364,460806,461172,461431,460624,460853,460817,461199,460855,460819,461651,461161,460579,460642,461983,461003,461521,461836,461008,460523,461809,461634,460527,460528,461518,461526,460502,460934,460937,461408,461629,460870,460868,461630,460500,461509,460504,461791,460530,461471,460531,461472,460999,460920,460692,461792,460671,461936,460698,461771,460699,460700,460702,460703,460707,461948,460709,460711,461705,461039,461467,460712,460713,461460,460714,461040,461752,460715,461352,460716,460717,460718,461041,461615,461078,461939,461079,461080,460831,461393,460832,461757,460833,460730,461498,461085,461086,460731,461938,460732,460736,461351,460742,461095,461540,461096,461097,461758,460858,460879,460880,460881,460882,460883,460885,460886,460887,460888,460889,460890,461383,460893,461875,460901,460903,461774,460921,461516,460922,460915,460918,461772,461100,461101,461773,461102,461103,461105,460924,460926,461360,460927,451131,451774,460951,461627,460947,460950,460961,461522,461110,461848,460967,461829,461819,460976,460977,461940,461111,460979,462025,461034,461238,461618,461035,461799,461517,461200,461159,461164,461230,461500,461214,461192,461154,461236,461217,461223,461787,460058,461389,451753,451883,451905,452020,451579,451571,451547,451685,460061,460361,460366,461933,461934,461046,460755,461259,461074,460675,460738,460787,461073,460737,461001,461344,460351,461006,461695,461288,461609,461009,461343,461763,460778,461764,460669,460697,461724,460722,461141,460754,460674,460756,460932,461730,460786,460758,461048,460759,461050,461260,461731,460767,460906,460836,461544,461059,461742,460694,460772,461061,460696,461064,460748,460695,460664,461062,460665,460666,461624,461613,461063,460773,460774,460775,460909,461704,460908,461706,460776,461639,460801,460618,450254,460175,460788,461688,460827,460826,461538,460693,461068,461469,462026,461004,460752,461399,461069,461070,461071,461281,461065,461726,460625,461072,461729,460620,461945,460781,461286,461319,460865,461798,461339,461369,460864,461453,461361,461735,460866,460526,461685,460850,461198,460075,461759,460750,460941,460795,460796,461676,460797,460567,461425,461813,460749,461607,460352,461474,460798,461835,461005,461781,461007,461321,461305,461367,461860,462027,461851,461379,461782,460996,461488,460063,460180,461461,461675,461002,460848,461775,461841,461520,460849,460862,461551,460993,461880,461378,461345,460489,461303,460859,460863,461365,461318,461323,461331,461662,461366,460710,461484,461550,460020,460172,461491,461421,460339,461179,461338,461324,460392,461131,461362,461329,460197,460942,461356,460201,460556,460357,460067,461602,461871,460014,460390,461410,460944,450826,460588,461554,460338,460367,461011,460343,461176,461252,461678,460575,460154,462009,461173,461032,460280,460938,461449,460829,461099,460626,461901,461094,461013,460380,461414,460619,461514,460690,460602,460287,460874,460995,461916,461012,460899,460900,460553,461641,461489,460345,460355,461222,460348,460607,460580,461178,460578,461010,460834,460070,461810,460198,461631,460549,460363,460344,461430,460902,461802,461241,460949,460948,461015,461325,461700,460013,460186,451726,450244,460021,461394,460190,460835,461493,461171,460022,460023,461328,460577,461341,461870,461985,461310,451519,452017,460388,460181,461381,460571,461783,461283,461786,461480,461376,461254,461468,460159,461542,460202,461304,460372,461497,461738,460583,460856,460763,461727,460764,461657,461444,460779,461710,461333,461984,460622,460623,461765,460907,462002,460661,461873,460769,461000,461487,461790,461789,461671,460627,460663,461818,460800,461942,461337,461334,461335,461314,461587,461588,460368,462015,460076,461541,460165,461881,460377,460365,461418,460078,461716,461673,460179,461732,460397,461717,460587,460171,460789,460585,460719,461466,461753,460939,461903,461902,460861,461066,461570,460721,460720,461443,461067,460784,460854,460828,461794,461042,461756,460928,460176,461044,461708,460520,461420,461098,460802,461294,461093,461459,460167,461846,461555,461761,460185,460564,461655,461442,460753,461842,461669,460024,460337,451985,451300,460017,461336,461386,460173,461515,461163,460791,461898,461897,460672,460673,461823,460782,461423,461899,461900,461045,461047,461612,460785,461767,460653,460760,461053,461737,460659,461709,460765,461054,460766,460660,461056,461256,461057,461617,460929,461906,460770,461058,461743,460662,461793,461519,461395,461698,461593,461990,461434,461416,461608,461504,461908,461483,461510,461436,461505,461437,461867,461499,461635,461696,461438,461439,461748,461872,461911,461502,461610,461963,461922,461987,461986,461965,461964,461962,461924,461953,461952,461951,461932,462011,462010,461955,461929,461969,461970,461966,461928,462000,462001,461956,461957,461971,461921,461927,461919,461920,461926,461923,462012,461931,461982,460095,460005,461481,460405,460006,461506,461202,460010,461429,461400,460011,461697,460025,461396,460037,460196,461734,450131,451620,461890,461889,460001,461935,460191,461490,460102,461295,460364,461446,461918,460103,460376,461390,460104,461620,460955,460804,461465,460110,460111,461680,460040,461562,461891,460112,461127,460164,461182,460003,460004,461707,460168,461428,460117,460163,461714,460187,461762,460384,460119,461884,461991,461106,460170,460121,461297,460398,461296,460407,460128,461494,480798,480819,480675,480503,410868,410277,410692,410281,410540,410282,411094,410283,411170,410553,410538,410534,411128,410560,410564,410883,410286,440250,410287,410291,440365,440339,440820,440332,440855,440355,440917,440906,440354,440334,440342,440902,440347,440178,440854,440578,440863,440806,440580,440181,440887,440606,440372,440357,450128,440611,450129,452024,451747,450200,450662,451861,450250,450238,452168,450247,450241,450245,451859,450140,450132,450223,452079,450225,450133,451305,451993,450749,451764,450134,450219,450217,450135,451812,450173,451866,450136,450137,450675,450677,451393,450421,450480,450455,450459,450898,450209,450233,450193,450503,451038,450418,451312,450334,450682,450138,452167,450139,451250,450986,452193,450430,451660,450704,451899,461355,461113,461130,460604,460189,461760,460869,461440,460027,460867,461850,460586,460166,460200,460169,461402,460182,460028,461877,460029,461626,460593,460851,460346,460353,460042,461847,450514,451360,450534,450525,450013,450011,450667,440478,460816,461118,450088,461243,460192,461016,450869,460177,461136,450437,440341,450531,461231,451468,450466,450004,450828,450442,450794,430551,451691,450537,460617,452076,461107,460012,461155,460009,461162,450516,440605,410542,410153,410573,450169,451775,450164,460184,461387,451651,460685,460818,450446,450523,461090,460768,460884,440183,440895,450907,451396,440362,450356,460876,450477,410811,460815,410266,410830,451133,461109,440727,452171,461527,411134,461561,451020,451635,452208]


	for file_type in list_file:
		list_df = []
		for hour in range(24):
			hour = '%02d'%hour
			ta_path = '%s/%s'%(path_daily, hour)
			#print("   Checking %s"%ta_path)
			if os.path.exists(ta_path):
				for file in os.listdir(ta_path):
					if file_type in file:
						if file_type != 'result_ue_cap':
							if file.endswith('.csv'):
								zip_file = '%s/%s.zip'%(ta_path, file_type)
								zf = zipfile.ZipFile(zip_file, "w", zipfile.ZIP_DEFLATED)
								zf.write('%s/%s'%(ta_path, file), '%s.csv'%file_type)
								zf.close()
								os.remove('%s/%s'%(ta_path, file))
								file = '%s.zip'%file_type
							
						#print("    reading %s %s %s %s on %s"%(file_type, enm, s_date, hour, datetime.now()))
						if len(dict_columns[file_type]) == 0:
							df_new = pd.read_csv('%s/%s'%(ta_path,file), delimiter=",", index_col=None, header='infer')
							df_new = df_new.loc[df_new['enodebid'].isin(list_site)]
							#df_new = df_new.loc[df_new['site'].isin(list_site)]
							if len(df_new) > 0:
								print('   Found %s data for MDT'%len(df_new))
								list_df.append(df_new)
						else:
							df_new = pd.read_csv('%s/%s'%(ta_path,file), delimiter=",", index_col=None, header='infer', usecols=dict_columns[file_type])
							df_new = df_new.loc[df_new['enodebid'].isin(list_site)]
							#df_new = df_new.loc[df_new['site'].isin(list_site)]
							if len(df_new) > 0:
								print('   Found %s data for MDT'%len(df_new))
								list_df.append(df_new)
		if len(list_df) > 0:
			df = pd.concat(list_df, axis=0)
			df.to_csv('%s/filter_%s.csv'%(path_daily, file_type), index=None)
			zip_file = '%s/filter_%s.zip'%(path_daily, file_type)
			zf = zipfile.ZipFile(zip_file, "w", zipfile.ZIP_DEFLATED)
			zf.write('%s/filter_%s.csv'%(path_daily, file_type), 'filter_%s.csv'%(file_type))
			zf.close()
			os.remove('%s/filter_%s.csv'%(path_daily, file_type))
			print('Result on %s/filter_%s.csv'%(path_daily, file_type))
			list_site_collected = df['enodebid'].unique().tolist()
			print('total %s sites found'%len(list_site_collected))

if __name__ == '__main__':
    warnings.filterwarnings('ignore')
    tanggal = datetime.now()
    delta_day = 58
    s_hour_2 = s_hour = 0
    s_date = s_date_2 = ""
    start_datetime = tanggal - timedelta(days=delta_day)
    stop_datetime = start_datetime
    if len(sys.argv) > 1:
        s_date = sys.argv[1]
        if len(sys.argv) >2:
            s_date_2 = sys.argv[2]
        else:
            s_date_2 = s_date

        start_datetime = datetime.strptime(s_date, '%Y%m%d')
        stop_datetime = datetime.strptime(s_date_2, '%Y%m%d')


    python_file_path = os.path.dirname(os.path.realpath(__file__))
    for dt in rrule.rrule(rrule.DAILY, dtstart=start_datetime, until=stop_datetime):
        sekarang = datetime.now()
        s_date = dt.strftime("%Y%m%d")
        print("combining MDT %s" %(s_date))


        combine_mdt(s_date)



    
    

    
    

