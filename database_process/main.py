{"payload":{"allShortcutsEnabled":true,"fileTree":{"":{"items":[{"name":"connectivity.py","path":"connectivity.py","contentType":"file"},{"name":"hardware.py","path":"hardware.py","contentType":"file"},{"name":"main.py","path":"main.py","contentType":"file"},{"name":"requirements.txt","path":"requirements.txt","contentType":"file"},{"name":"result-merge_20230321.xlsx","path":"result-merge_20230321.xlsx","contentType":"file"},{"name":"tower.py","path":"tower.py","contentType":"file"}],"totalCount":6}},"fileTreeProcessingTime":3.7565939999999998,"foldersToFetch":[],"reducedMotionEnabled":"system","repo":{"id":548190991,"defaultBranch":"master","name":"database_consolidate","ownerLogin":"mohgavin","currentUserCanPush":true,"isFork":false,"isEmpty":false,"createdAt":"2022-10-09T11:28:11.000+07:00","ownerAvatar":"https://avatars.githubusercontent.com/u/67898944?v=4","public":false,"private":true,"isOrgOwned":false},"symbolsExpanded":true,"treeExpanded":true,"refInfo":{"name":"master","listCacheKey":"v0:1668214275.488021","canEdit":true,"refType":"branch","currentOid":"98e4ce41690feeafa008753c91920d3935006323"},"path":"main.py","currentUser":{"id":67898944,"login":"mohgavin","userEmail":"mohammad.gavin@gmail.com"},"blob":{"rawLines":["#!/home/nivag/database_consolidate/.env/bin/python","","from hardware import Hardware, Radio_Sector","from connectivity import RET_Status, BB_Port","from tower import Tower, BTSWeb","from datetime import date","from functools import reduce","","import time","import pandas as pd","","def main():","   ","    s = time.perf_counter()","","    towerid     = Tower('Tower ID - Site ID Collo_20230301.xlsx').return_result()","    btsw        = BTSWeb('BtsNewReport-20230301.zip').return_result()","    hardware    = Hardware('HW_inventory_All_OSS-ENM_20230320.csv.gz').newmethod_tech_hardware()","    radiosector = Radio_Sector('2G_3G_4G_ESS_NBIOT_20230305_FINAL.xlsb').newmethod1_radiosector()","    ret         = RET_Status('HW_RET_inventory_All_ENM_20230301.csv.gz').return_result()","    bbport      = BB_Port('Port_Utilization_Report_All_ENM_20230301.csv.gz').return_result()","","    list_zip_df = list(zip(towerid, btsw, hardware, bbport, ret, radiosector)) ","","    df1 = reduce(lambda  left,right: pd.merge(left,right,on='Special_Tower_ID_mapping_for_Tower_ID_with_more_than_1_site_ID', how='outer'), list_zip_df[0])","","    df2 = pd.concat(list_zip_df[1], axis=0, ignore_index =True)","","    df1.rename(index={'level_1': 'Special_Tower_ID_mapping_for_Tower_ID_with_more_than_1_site_ID'}, inplace=True)","","    with pd.ExcelWriter(f'~/database_consolidate/result/result-merge_{date.today().strftime(\"%Y%m%d\")}.xlsx', engine='xlsxwriter') as writer:  ","        df1.to_excel(writer, header=False, sheet_name='Consolidate DB')","        df2.to_excel(writer, header=True, sheet_name='Log-Date')","","    elapsed = time.perf_counter() - s","    print(f\"{__file__} executed in {elapsed:0.2f} seconds.\")","    ","if __name__ == '__main__':","    ","    main()"],"stylingDirectives":[[{"start":0,"end":50,"cssClass":"pl-c"}],[],[{"start":0,"end":4,"cssClass":"pl-k"},{"start":5,"end":13,"cssClass":"pl-s1"},{"start":14,"end":20,"cssClass":"pl-k"},{"start":21,"end":29,"cssClass":"pl-v"},{"start":31,"end":43,"cssClass":"pl-v"}],[{"start":0,"end":4,"cssClass":"pl-k"},{"start":5,"end":17,"cssClass":"pl-s1"},{"start":18,"end":24,"cssClass":"pl-k"},{"start":25,"end":35,"cssClass":"pl-v"},{"start":37,"end":44,"cssClass":"pl-v"}],[{"start":0,"end":4,"cssClass":"pl-k"},{"start":5,"end":10,"cssClass":"pl-s1"},{"start":11,"end":17,"cssClass":"pl-k"},{"start":18,"end":23,"cssClass":"pl-v"},{"start":25,"end":31,"cssClass":"pl-v"}],[{"start":0,"end":4,"cssClass":"pl-k"},{"start":5,"end":13,"cssClass":"pl-s1"},{"start":14,"end":20,"cssClass":"pl-k"},{"start":21,"end":25,"cssClass":"pl-s1"}],[{"start":0,"end":4,"cssClass":"pl-k"},{"start":5,"end":14,"cssClass":"pl-s1"},{"start":15,"end":21,"cssClass":"pl-k"},{"start":22,"end":28,"cssClass":"pl-s1"}],[],[{"start":0,"end":6,"cssClass":"pl-k"},{"start":7,"end":11,"cssClass":"pl-s1"}],[{"start":0,"end":6,"cssClass":"pl-k"},{"start":7,"end":13,"cssClass":"pl-s1"},{"start":14,"end":16,"cssClass":"pl-k"},{"start":17,"end":19,"cssClass":"pl-s1"}],[],[{"start":0,"end":3,"cssClass":"pl-k"},{"start":4,"end":8,"cssClass":"pl-en"}],[],[{"start":4,"end":5,"cssClass":"pl-s1"},{"start":6,"end":7,"cssClass":"pl-c1"},{"start":8,"end":12,"cssClass":"pl-s1"},{"start":13,"end":25,"cssClass":"pl-en"}],[],[{"start":4,"end":11,"cssClass":"pl-s1"},{"start":16,"end":17,"cssClass":"pl-c1"},{"start":18,"end":23,"cssClass":"pl-v"},{"start":24,"end":64,"cssClass":"pl-s"},{"start":66,"end":79,"cssClass":"pl-en"}],[{"start":4,"end":8,"cssClass":"pl-s1"},{"start":16,"end":17,"cssClass":"pl-c1"},{"start":18,"end":24,"cssClass":"pl-v"},{"start":25,"end":52,"cssClass":"pl-s"},{"start":54,"end":67,"cssClass":"pl-en"}],[{"start":4,"end":12,"cssClass":"pl-s1"},{"start":16,"end":17,"cssClass":"pl-c1"},{"start":18,"end":26,"cssClass":"pl-v"},{"start":27,"end":69,"cssClass":"pl-s"},{"start":71,"end":94,"cssClass":"pl-en"}],[{"start":4,"end":15,"cssClass":"pl-s1"},{"start":16,"end":17,"cssClass":"pl-c1"},{"start":18,"end":30,"cssClass":"pl-v"},{"start":31,"end":71,"cssClass":"pl-s"},{"start":73,"end":95,"cssClass":"pl-en"}],[{"start":4,"end":7,"cssClass":"pl-s1"},{"start":16,"end":17,"cssClass":"pl-c1"},{"start":18,"end":28,"cssClass":"pl-v"},{"start":29,"end":71,"cssClass":"pl-s"},{"start":73,"end":86,"cssClass":"pl-en"}],[{"start":4,"end":10,"cssClass":"pl-s1"},{"start":16,"end":17,"cssClass":"pl-c1"},{"start":18,"end":25,"cssClass":"pl-v"},{"start":26,"end":75,"cssClass":"pl-s"},{"start":77,"end":90,"cssClass":"pl-en"}],[],[{"start":4,"end":15,"cssClass":"pl-s1"},{"start":16,"end":17,"cssClass":"pl-c1"},{"start":18,"end":22,"cssClass":"pl-en"},{"start":23,"end":26,"cssClass":"pl-en"},{"start":27,"end":34,"cssClass":"pl-s1"},{"start":36,"end":40,"cssClass":"pl-s1"},{"start":42,"end":50,"cssClass":"pl-s1"},{"start":52,"end":58,"cssClass":"pl-s1"},{"start":60,"end":63,"cssClass":"pl-s1"},{"start":65,"end":76,"cssClass":"pl-s1"}],[],[{"start":4,"end":7,"cssClass":"pl-s1"},{"start":8,"end":9,"cssClass":"pl-c1"},{"start":10,"end":16,"cssClass":"pl-en"},{"start":17,"end":23,"cssClass":"pl-k"},{"start":25,"end":29,"cssClass":"pl-s1"},{"start":30,"end":35,"cssClass":"pl-s1"},{"start":37,"end":39,"cssClass":"pl-s1"},{"start":40,"end":45,"cssClass":"pl-en"},{"start":46,"end":50,"cssClass":"pl-s1"},{"start":51,"end":56,"cssClass":"pl-s1"},{"start":57,"end":59,"cssClass":"pl-s1"},{"start":59,"end":60,"cssClass":"pl-c1"},{"start":60,"end":124,"cssClass":"pl-s"},{"start":126,"end":129,"cssClass":"pl-s1"},{"start":129,"end":130,"cssClass":"pl-c1"},{"start":130,"end":137,"cssClass":"pl-s"},{"start":140,"end":151,"cssClass":"pl-s1"},{"start":152,"end":153,"cssClass":"pl-c1"}],[],[{"start":4,"end":7,"cssClass":"pl-s1"},{"start":8,"end":9,"cssClass":"pl-c1"},{"start":10,"end":12,"cssClass":"pl-s1"},{"start":13,"end":19,"cssClass":"pl-en"},{"start":20,"end":31,"cssClass":"pl-s1"},{"start":32,"end":33,"cssClass":"pl-c1"},{"start":36,"end":40,"cssClass":"pl-s1"},{"start":40,"end":41,"cssClass":"pl-c1"},{"start":41,"end":42,"cssClass":"pl-c1"},{"start":44,"end":56,"cssClass":"pl-s1"},{"start":57,"end":58,"cssClass":"pl-c1"},{"start":58,"end":62,"cssClass":"pl-c1"}],[],[{"start":4,"end":7,"cssClass":"pl-s1"},{"start":8,"end":14,"cssClass":"pl-en"},{"start":15,"end":20,"cssClass":"pl-s1"},{"start":20,"end":21,"cssClass":"pl-c1"},{"start":22,"end":31,"cssClass":"pl-s"},{"start":33,"end":97,"cssClass":"pl-s"},{"start":100,"end":107,"cssClass":"pl-s1"},{"start":107,"end":108,"cssClass":"pl-c1"},{"start":108,"end":112,"cssClass":"pl-c1"}],[],[{"start":4,"end":8,"cssClass":"pl-k"},{"start":9,"end":11,"cssClass":"pl-s1"},{"start":12,"end":23,"cssClass":"pl-v"},{"start":24,"end":108,"cssClass":"pl-s"},{"start":69,"end":102,"cssClass":"pl-s1"},{"start":69,"end":70,"cssClass":"pl-kos"},{"start":70,"end":74,"cssClass":"pl-s1"},{"start":75,"end":80,"cssClass":"pl-en"},{"start":83,"end":91,"cssClass":"pl-en"},{"start":92,"end":100,"cssClass":"pl-s"},{"start":101,"end":102,"cssClass":"pl-kos"},{"start":110,"end":116,"cssClass":"pl-s1"},{"start":116,"end":117,"cssClass":"pl-c1"},{"start":117,"end":129,"cssClass":"pl-s"},{"start":131,"end":133,"cssClass":"pl-k"},{"start":134,"end":140,"cssClass":"pl-s1"}],[{"start":8,"end":11,"cssClass":"pl-s1"},{"start":12,"end":20,"cssClass":"pl-en"},{"start":21,"end":27,"cssClass":"pl-s1"},{"start":29,"end":35,"cssClass":"pl-s1"},{"start":35,"end":36,"cssClass":"pl-c1"},{"start":36,"end":41,"cssClass":"pl-c1"},{"start":43,"end":53,"cssClass":"pl-s1"},{"start":53,"end":54,"cssClass":"pl-c1"},{"start":54,"end":70,"cssClass":"pl-s"}],[{"start":8,"end":11,"cssClass":"pl-s1"},{"start":12,"end":20,"cssClass":"pl-en"},{"start":21,"end":27,"cssClass":"pl-s1"},{"start":29,"end":35,"cssClass":"pl-s1"},{"start":35,"end":36,"cssClass":"pl-c1"},{"start":36,"end":40,"cssClass":"pl-c1"},{"start":42,"end":52,"cssClass":"pl-s1"},{"start":52,"end":53,"cssClass":"pl-c1"},{"start":53,"end":63,"cssClass":"pl-s"}],[],[{"start":4,"end":11,"cssClass":"pl-s1"},{"start":12,"end":13,"cssClass":"pl-c1"},{"start":14,"end":18,"cssClass":"pl-s1"},{"start":19,"end":31,"cssClass":"pl-en"},{"start":34,"end":35,"cssClass":"pl-c1"},{"start":36,"end":37,"cssClass":"pl-s1"}],[{"start":4,"end":9,"cssClass":"pl-en"},{"start":10,"end":59,"cssClass":"pl-s"},{"start":12,"end":22,"cssClass":"pl-s1"},{"start":12,"end":13,"cssClass":"pl-kos"},{"start":13,"end":21,"cssClass":"pl-s1"},{"start":21,"end":22,"cssClass":"pl-kos"},{"start":35,"end":49,"cssClass":"pl-s1"},{"start":35,"end":36,"cssClass":"pl-kos"},{"start":36,"end":43,"cssClass":"pl-s1"},{"start":48,"end":49,"cssClass":"pl-kos"}],[],[{"start":0,"end":2,"cssClass":"pl-k"},{"start":3,"end":11,"cssClass":"pl-s1"},{"start":12,"end":14,"cssClass":"pl-c1"},{"start":15,"end":25,"cssClass":"pl-s"}],[],[{"start":4,"end":8,"cssClass":"pl-en"}]],"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":null,"configFilePath":null,"networkDependabotPath":"/mohgavin/database_consolidate/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":false,"repoAlertsPath":"/mohgavin/database_consolidate/security/dependabot","repoSecurityAndAnalysisPath":"/mohgavin/database_consolidate/settings/security_analysis","repoOwnerIsOrg":false,"currentUserCanAdminRepo":true},"displayName":"main.py","displayUrl":"https://github.com/mohgavin/database_consolidate/blob/master/main.py?raw=true","headerInfo":{"blobSize":"1.64 KB","deleteInfo":{"deleteTooltip":"Delete this file"},"editInfo":{"editTooltip":"Edit this file"},"ghDesktopPath":"https://desktop.github.com","gitLfsPath":null,"onBranch":true,"shortPath":"d5184dd","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2Fmohgavin%2Fdatabase_consolidate%2Fblob%2Fmaster%2Fmain.py","isCSV":false,"isRichtext":false,"toc":null,"lineInfo":{"truncatedLoc":"40","truncatedSloc":"27"},"mode":"executable file"},"image":false,"isCodeownersFile":null,"isPlain":false,"isValidLegacyIssueTemplate":false,"issueTemplateHelpUrl":"https://docs.github.com/articles/about-issue-and-pull-request-templates","issueTemplate":null,"discussionTemplate":null,"language":"Python","languageID":303,"large":false,"loggedIn":true,"newDiscussionPath":"/mohgavin/database_consolidate/discussions/new","newIssuePath":"/mohgavin/database_consolidate/issues/new","planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/mohgavin/database_consolidate/blob/master/main.py","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","dismissStackNoticePath":"/settings/dismiss-notice/publish_stack_from_file","releasePath":"/mohgavin/database_consolidate/releases/new?marketplace=true","showPublishActionBanner":false,"showPublishStackBanner":false},"rawBlobUrl":"https://github.com/mohgavin/database_consolidate/raw/master/main.py","renderImageOrRaw":false,"richText":null,"renderedFileInfo":null,"shortPath":null,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"repoOwner":"mohgavin","repoName":"database_consolidate","showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","showDependabotConfigurationBanner":null,"actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timedOut":false,"notAnalyzed":false,"symbols":[{"name":"main","kind":"function","identStart":266,"identEnd":270,"extentStart":262,"extentEnd":1635,"fullyQualifiedName":"main","identUtf16":{"start":{"lineNumber":11,"utf16Col":4},"end":{"lineNumber":11,"utf16Col":8}},"extentUtf16":{"start":{"lineNumber":11,"utf16Col":0},"end":{"lineNumber":35,"utf16Col":60}}}]}},"copilotInfo":{"documentationUrl":"https://docs.github.com/copilot/overview-of-github-copilot/about-github-copilot-for-individuals","notices":{"codeViewPopover":{"dismissed":false,"dismissPath":"/settings/dismiss-notice/code_view_copilot_popover"}},"userAccess":{"accessAllowed":false,"hasSubscriptionEnded":false,"orgHasCFBAccess":false,"userHasCFIAccess":false,"userHasOrgs":false,"userIsOrgAdmin":false,"userIsOrgMember":false,"business":null,"featureRequestInfo":null}},"csrf_tokens":{"/mohgavin/database_consolidate/branches":{"post":"hsMvY55sLKQ2dPOuLUHhw3WqgrZNzbkNIuPUnbk87IZvc_iQp8F86ojMdMbT8Q629y0PZsA7PcyBHTsq15nDUA"},"/repos/preferences":{"post":"2YneK4YpVeNmQLA-ke2qpFAcN6rjjWAJSr5YqFn7plPFYV34hapI7B1Ib4o777D2TOB-3MZh8a02TR0GH2o0Mg"}}},"title":"database_consolidate/main.py at master Â· mohgavin/database_consolidate"}